{"version":3,"sources":["../../src/pages/profile-details/profile-details.module.ts","../../src/pages/profile-details/profile-details.ts"],"names":[],"mappings":"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","file":"6.main.js","sourcesContent":["//home.module.ts\nimport { NgModule } from '@angular/core';\nimport { ProfileDetailsPage} from './profile-details';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [ProfileDetailsPage],\n  imports: [IonicPageModule.forChild(ProfileDetailsPage)],\n})\nexport class ProfileDetailsPageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile-details/profile-details.module.ts","import { Component } from '@angular/core';\n\n/*import { EditProfilePage } from \"./edit-profile/edit-profile\";*/\n\nimport { Storage } from \"@ionic/storage\";\nimport { NavController, AlertController, ToastController, LoadingController } from \"ionic-angular\";\nimport { IonicPage } from 'ionic-angular';\nimport { FirebaseListObservable, AngularFireDatabase } from \"angularfire2/database\";\nimport { Auth } from \"../../providers/auth/auth\";\n\nimport firebase from 'firebase';\n\nimport { Http, RequestOptions, Headers } from \"@angular/http\";\nimport { Observable } from \"rxjs\";\n\n@IonicPage()\n@Component({\n  selector: 'page-profile-details',\n  templateUrl: 'profile-details.html',\n})\nexport class ProfileDetailsPage {\n/*  editprofilePage = EditProfilePage;*/\nuser: FirebaseListObservable<any>;\n  userDetails : any;\n  username : string;\n  showUserDetails : boolean = false;\n  public renewalDate: any;\n  public loader: any;\n  public subscriptionStatus: any;\n\n  constructor(\n\n    private storage: Storage,\n    private navCtrl : NavController,\n    private af: AngularFireDatabase,\n    private auth : Auth,\n    public alertCtrl: AlertController,\n    public loadingCtrl: LoadingController,\n    public toastCtrl: ToastController,\n    public http: Http\n  ) {\n    \n      this.storage.get('uid').then((response)=>{\n        let userData = firebase.database().ref('/userProfile/' + response);\n        userData.once(\"value\", (snapshot) => {\n          this.userDetails =  snapshot.val();\n        })\n      })\n      \n\n  }\n\n  ionViewDidEnter() {\n    this.storage.get('uid').then((uid) => {\n      let userData = firebase.database().ref('/userProfile/');\n      userData.child(uid).once(\"value\", (snapshot) => {\n          this.prepareRequest('http://yaspat.deapps.io:3002/users/get_agreement', `agreement_id=${snapshot.val().subscription}`).subscribe((data) => {\n            let agreementDetails = JSON.parse(data._body);\n            this.subscriptionStatus = agreementDetails.user_state;\n            if(agreementDetails && agreementDetails.agreement_details.next_billing_date) {\n              var str = agreementDetails.agreement_details.next_billing_date;\n              var date = new Date(str);\n              var day = date.getDate();\n              var month = date.getMonth() + 1;\n              var year = date.getFullYear();\n              this.renewalDate = { day: day, month: month, year: year, agreementId: agreementDetails.id };\n            } else {\n              this.renewalDate = null;\n            }\n          });\n      });\n    });\n\n  }\n\n  unSubscribe() {\n    let alert = this.alertCtrl.create({\n      title: 'Unsubscribe',\n      message: 'Are you sure you want to unsubscribe?',\n      buttons: [\n        {\n          text: 'No',\n          role: 'cancel',\n          handler: () => {\n            console.log('Cancel clicked');\n          }\n        },\n        {\n          text: 'Yes',\n          handler: () => {\n            this.loader = this.loadingCtrl.create({\n              content: 'Unsubscribing...'\n            });\n            this.loader.present();\n            this.prepareRequest('http://yaspat.deapps.io:3002/users/cancel_agreement', `agreement_id=${this.renewalDate.agreementId}`).subscribe((data) => {\n\n              let cancelData = JSON.parse(data._body);\n              if (cancelData.statusCode == 204) {\n                this.loader.dismiss();\n                let toast = this.toastCtrl.create({\n                  message: 'Unsubscribed Successfully',\n                  duration: 3000,\n                  position: 'top'\n                });\n\n                toast.onDidDismiss(() => {\n                  this.ionViewDidEnter();\n                });\n\n                toast.present();\n              } else {\n                this.loader.dismiss();\n                let toast = this.toastCtrl.create({\n                  message: 'Something went wrong',\n                  duration: 3000,\n                  position: 'top'\n                });\n\n                toast.present();\n              }\n            });\n          }\n        }\n      ]\n    });\n    alert.present();\n  }\n\n  prepareRequest(url, body) {\n    let options = {\n      headers: this.prepareHeaders(),\n    }\n\n    return this.http.post(url, body, options)\n      .map((res) => this.prepareData(res)).catch((error) => this.handleError(error));\n  }\n\n  private handleError(err: any) {\n    if (err) {\n    }\n    return Observable.throw(2, err);\n  }\n\n  private prepareData(res: any) {\n    return res;\n  }\n\n  prepareHeaders() {\n    let headers = new Headers();\n    headers.append('Content-Type', 'application/x-www-form-urlencoded');\n    return headers;\n  }\n\n  gotoEditProfilePage(){\n    this.navCtrl.push('EditProfilePage');\n  }\n\n\n}\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile-details/profile-details.ts"],"sourceRoot":""}