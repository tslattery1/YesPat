{"version":3,"sources":["../../src/pages/login/login.module.ts","../../src/pages/login/login.ts"],"names":[],"mappings":"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","file":"10.main.js","sourcesContent":["//home.module.ts\nimport { NgModule } from '@angular/core';\nimport { LoginPage} from './login';\nimport { IonicPageModule } from 'ionic-angular';\n\n@NgModule({\n  declarations: [LoginPage],\n  imports: [IonicPageModule.forChild(LoginPage)],\n})\nexport class LoginPageModule { }\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.module.ts","import { OneSignal } from '@ionic-native/onesignal';\nimport { Component } from '@angular/core';\nimport { NgForm } from \"@angular/forms/forms\";\nimport { NavController, Events, MenuController } from \"ionic-angular\";\n\n\n\n\nimport { Storage } from \"@ionic/storage\";\nimport { IonicPage, AlertController, LoadingController } from 'ionic-angular';\nimport { Auth } from \"../../providers/auth/auth\";\nimport { AngularFireDatabase, FirebaseListObservable, FirebaseObjectObservable } from \"angularfire2/database\";\nimport firebase from 'firebase';\nimport { MyApp } from \"../../app/app.component\";\n\n@IonicPage()\n@Component({\n  selector: 'page-login',\n  templateUrl: 'login.html',\n})\n\nexport class LoginPage {\n  /*  signinpage = SignupPage;*/\n\n  email;\n  password;\n  validLoginDetails: boolean = true;\n  users: FirebaseObjectObservable<any>;\n  loading: any\n\n  constructor(\n    private navCtrl: NavController,\n    private menuCtrl: MenuController,\n    private auth: Auth,\n    private storage: Storage,\n    private alertCtrl: AlertController,\n    private af: AngularFireDatabase,\n    private app: MyApp,\n    private event: Events,\n    private oneSignal: OneSignal,\n    public loadingCtrl: LoadingController\n\n\n  ) { }\n\n  public ngOnInit() {\n    this.menuCtrl.enable(false);\n  }\n\n  onSubmit(form: NgForm) {\n    this.loading = this.loadingCtrl.create({\n      content: 'logging you in...'\n    });\n\n    this.loading.present();\n\n    let user = form.value;\n\n    this.auth.loginUser(form.value.email, form.value.password)\n      .then((authData) => {\n\n        this.storage.set(\"uid\", authData.uid);\n        \n        var userData = firebase.database().ref('/userProfile/');\n        userData.child(authData.uid).once(\"value\", (snapshot) => {\n          let userInfo = {\n            username: snapshot.val().username,\n            user_role: snapshot.val().user_role,\n            points: snapshot.val().points\n          }\n\n          this.oneSignal.getIds().then((ids) => {\n            var userData = firebase.database().ref('/userProfile/');\n            userData.child(authData.uid).update({\n              playerId: ids.userId,\n              pushToken: ids.pushToken, \n            });\n\n            this.storage.set(\"userInfo\", userInfo); \n            this.event.publish('userLogin', {\"name\":snapshot.val().name, \"user_role\": snapshot.val().user_role, \"points\": snapshot.val().points});\n            this.menuCtrl.enable(true);\n\n            console.log('Role Login', snapshot.val().user_role);\n\n            if(snapshot.val().user_role !== 'bussinesssUser') {\n              console.log('Normal User');\n              if (this.loading) {\n                this.loading.dismiss();\n              }\n              this.navCtrl.setRoot('PostFindspotPage');\n            } else {\n              console.log('Bussiness User', authData.uid);\n              this.users = this.af.object('/businessProfile/' + authData.uid);\n              this.users.subscribe((data) => {\n                 if(data.$value !== null){\n                  if(!data.bussiness_verify) {\n                    if (this.loading) {\n                      this.loading.dismiss();\n                    }\n                    this.navCtrl.setRoot('BussinessVerificationAlertPage');\n                  } else {\n                    if (this.loading) {\n                      this.loading.dismiss();\n                    }\n                    this.navCtrl.setRoot('BussinessAddMenuPage');\n                  }\n                 } else {\n                  if (this.loading) {\n                    this.loading.dismiss();\n                  }\n                  this.navCtrl.setRoot('BussinessSignUpPage');\n                 }\n              }, (error) => {\n                if (this.loading) {\n                  this.loading.dismiss();\n                }\n                console.log('Error', error);\n              });\n            }\n  \n            // this.navCtrl.setRoot(MyApp);\n          })\n          //console.log(JSON.stringify(data));\n        }).catch((error) => {\n          if (this.loading) {\n            this.loading.dismiss();\n          }\n        })\n        //this.users.push({'username':'prasadr'});\n        // console.log(this.users);\n\n        /*   setTimeout(()=>{\n             window.location.reload();\n           },150)*/\n\n\n\n      },\n      error => {\n        console.log(error.message);\n        this.validLoginDetails = false;\n        if (this.loading) {\n          this.loading.dismiss();\n        }\n      }\n\n      )\n\n\n  }\n\n  gotoSignUpPage() {\n    this.navCtrl.push('SignupPage');\n  }\n\n  forgotpassPage() {\n    this.navCtrl.push('ForgotpasswordPage');\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/pages/login/login.ts"],"sourceRoot":""}